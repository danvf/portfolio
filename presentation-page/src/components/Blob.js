import React, { Component } from "react";
import BlobButtons from "./BlobButtons";
import { Spring, animated } from "react-spring/renderprops";
import { interpolate } from "flubber";
import { easeSinInOut } from "d3-ease";
import "../style/blob.scss";

class Blob extends Component {
    constructor(props) {
        super(props);

        this.state = {
            index: 0,
            paths: [
                "M40.9,-70.8C55.1,-62.7,70.1,-55.9,80,-44.3C89.8,-32.8,94.4,-16.4,92.9,-0.9C91.4,14.6,83.7,29.3,74.2,41.4C64.6,53.4,53.2,63,40.6,68C27.9,73.1,13.9,73.8,-1.1,75.8C-16.2,77.8,-32.5,81.1,-43.1,74.8C-53.6,68.5,-58.5,52.6,-62.3,38.5C-66.1,24.4,-68.7,12.2,-69.5,-0.4C-70.2,-13.1,-69.2,-26.2,-65.2,-40C-61.3,-53.8,-54.5,-68.2,-43.2,-78C-31.8,-87.7,-15.9,-92.7,-1.3,-90.5C13.4,-88.3,26.8,-78.9,40.9,-70.8Z",
                "M40.2,-69.9C49.9,-63.9,54.2,-48.9,59.4,-35.7C64.6,-22.5,70.7,-11.3,74.1,2C77.6,15.3,78.5,30.5,72.6,42.6C66.8,54.7,54.3,63.5,41.1,68.2C27.9,72.8,13.9,73.3,1.5,70.7C-11,68.2,-22,62.7,-33.2,56.8C-44.3,51,-55.6,44.8,-63.7,35.3C-71.8,25.8,-76.7,12.9,-76.1,0.3C-75.5,-12.2,-69.4,-24.4,-63.6,-37.9C-57.9,-51.5,-52.4,-66.3,-41.8,-71.9C-31.3,-77.4,-15.6,-73.6,-0.2,-73.2C15.2,-72.9,30.4,-75.9,40.2,-69.9Z",
                "M36.5,-63.6C47.1,-57.1,55.3,-46.9,60.8,-35.6C66.4,-24.4,69.4,-12.2,68.3,-0.7C67.2,10.9,61.8,21.8,55.2,31.1C48.5,40.4,40.4,48.3,31,53.6C21.6,59,10.8,61.9,-0.4,62.6C-11.6,63.3,-23.2,61.8,-34.1,57.3C-45,52.8,-55.2,45.3,-64.8,35.2C-74.5,25.2,-83.6,12.6,-84,-0.2C-84.4,-13,-76.1,-26.1,-67.1,-37.2C-58,-48.4,-48.4,-57.7,-37.1,-63.7C-25.8,-69.8,-12.9,-72.6,0,-72.6C13,-72.7,25.9,-70,36.5,-63.6Z",
                "M41.4,-71.2C55.3,-63.8,69.2,-55.9,78.4,-43.9C87.6,-32,92.1,-16,89.8,-1.4C87.4,13.3,78.2,26.5,68.5,37.6C58.7,48.7,48.5,57.5,37,66.2C25.5,74.9,12.8,83.5,-1.3,85.9C-15.5,88.2,-30.9,84.2,-43.3,76.1C-55.8,67.9,-65.2,55.5,-73.8,42.1C-82.3,28.7,-90,14.4,-90.2,-0.1C-90.4,-14.6,-83,-29.1,-73.9,-41.6C-64.9,-54.1,-54,-64.5,-41.4,-72.6C-28.8,-80.8,-14.4,-86.7,-0.3,-86.1C13.8,-85.6,27.6,-78.6,41.4,-71.2Z",
                "M37.6,-63.5C49.3,-58.3,59.8,-49.5,64.5,-38.3C69.2,-27.1,68.1,-13.5,67.6,-0.3C67,12.9,67.1,25.9,62.9,37.8C58.6,49.7,49.9,60.6,38.7,66C27.5,71.4,13.8,71.2,-0.6,72.3C-15.1,73.4,-30.1,75.8,-39.5,69.4C-48.8,62.9,-52.4,47.6,-60.7,34.6C-69.1,21.6,-82.1,10.8,-86.6,-2.6C-91,-15.9,-86.8,-31.8,-78.3,-44.5C-69.8,-57.2,-56.9,-66.7,-43.1,-70.7C-29.3,-74.7,-14.7,-73.2,-0.9,-71.7C12.9,-70.2,25.8,-68.6,37.6,-63.5Z",
            ],
        };
    }

    goNext = () => {
        this.setState({
            index:
                this.state.index + 1 >= this.state.paths.length
                    ? 0
                    : this.state.index + 1,
        });
        console.log(this.state.index);
    };

    render() {
        const { paths, index } = this.state;
        const interpolator = interpolate(
            paths[index],
            paths[index + 1 >= paths.length ? 0 : index + 1],
            {
                maxSegmentLenght: 0.1,
            }
        );

        return (
            <div className="blob-box">
                <svg
                    width="640"
                    viewBox="0 0 200 200"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <Spring
                        from={{ t: 0 }}
                        to={{ t: 1 }}
                        config={{
                            duration: 1400,
                            easing: easeSinInOut,
                        }}
                        onRest={this.goNext}
                        reset
                    >
                        {(props) => (
                            <animated.path
                                transform="translate(100 100)"
                                fill="#000000"
                                d={interpolator(props.t)}
                            />
                        )}
                    </Spring>

                    <text
                        className="dvf"
                        x="49%"
                        y="42%"
                        dominant-baseline="middle"
                        text-anchor="middle"
                    >
                        dvf
                    </text>
                    <text
                        className="front-end-dev"
                        x="50%"
                        y="50%"
                        dominant-baseline="middle"
                        text-anchor="middle"
                    >
                        {"< front-end developer />"}
                    </text>
                </svg>

                <BlobButtons />
            </div>
        );
    }
}

export default Blob;
